<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data:;"
    />
    <title>Library Management System</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=DM+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="css/main.css" />
  </head>

  <body data-theme="dark">
    <!-- Grain Texture Overlay -->
    <div class="grain-overlay"></div>

    <div class="container">
      <!-- ==================== HEADER ==================== -->
      <header class="header">
        <div class="header-content">
          <div class="header-top">
            <div class="header-left">
              <div class="logo-container">
                <div class="logo-icon">
                  <svg
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                    />
                    <path
                      d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                    />
                    <path
                      d="M8 7h8M8 11h6"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="round"
                    />
                  </svg>
                </div>
                <div class="logo-text">
                  <h1>Library<br />Management</h1>
                  <p class="subtitle">Aquaculture Unit</p>
                </div>
              </div>
            </div>

            <button
              class="theme-toggle"
              onclick="toggleTheme()"
              aria-label="Toggle theme"
              title="Toggle Dark/Light Theme"
            >
              <span class="theme-icon sun-icon">‚òÄÔ∏è</span>
              <span class="theme-icon moon-icon">üåô</span>
            </button>
          </div>

          <!-- Statistics Cards -->
          <div class="header-stats-grid">
            <div class="stat-card" data-stat="students">
              <div class="stat-icon">üë•</div>
              <div class="stat-content">
                <div class="stat-value" id="totalStudents">0</div>
                <div class="stat-label">Total Students</div>
              </div>
            </div>

            <div class="stat-card" data-stat="books">
              <div class="stat-icon">üìö</div>
              <div class="stat-content">
                <div class="stat-value" id="totalBooks">0</div>
                <div class="stat-label">Total Books</div>
              </div>
            </div>

            <div class="stat-card" data-stat="available">
              <div class="stat-icon">‚úì</div>
              <div class="stat-content">
                <div class="stat-value" id="availableCopies">0</div>
                <div class="stat-label">Available</div>
              </div>
            </div>

            <div class="stat-card" data-stat="issued">
              <div class="stat-icon">üìñ</div>
              <div class="stat-content">
                <div class="stat-value" id="issuedBooks">0</div>
                <div class="stat-label">Issued</div>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- ==================== NAVIGATION ==================== -->
      <nav class="tabs">
        <button
          class="tab-button active"
          onclick="showTab('dashboard')"
          data-tab="dashboard"
        >
          <span class="tab-icon">üè†</span>
          <span class="tab-label">Dashboard</span>
        </button>
        <button
          class="tab-button"
          onclick="showTab('students')"
          data-tab="students"
        >
          <span class="tab-icon">üë®‚Äçüéì</span>
          <span class="tab-label">Students</span>
        </button>
        <button class="tab-button" onclick="showTab('books')" data-tab="books">
          <span class="tab-icon">üìï</span>
          <span class="tab-label">Books</span>
        </button>
        <button
          class="tab-button"
          onclick="showTab('transactions')"
          data-tab="transactions"
        >
          <span class="tab-icon">üîÑ</span>
          <span class="tab-label">Transactions</span>
        </button>
      </nav>

      <!-- ==================== DASHBOARD TAB ==================== -->
      <div id="dashboard" class="tab-content active">
        <div class="dashboard-hero">
          <h2 class="dashboard-title">Welcome Back</h2>
          <p class="dashboard-subtitle">
            Here's what's happening in your library today
          </p>
        </div>

        <div class="dashboard-layout">
          <!-- Quick Actions -->
          <div class="quick-actions">
            <h3 class="section-title">Quick Actions</h3>
            <div class="action-cards">
              <button
                class="action-card"
                onclick="
                  showTab('students');
                  showAddStudentForm();
                "
              >
                <div class="action-icon">‚ûï</div>
                <div class="action-text">
                  <div class="action-title">Add Student</div>
                  <div class="action-desc">Register new student</div>
                </div>
              </button>

              <button
                class="action-card"
                onclick="
                  showTab('books');
                  showAddBookForm();
                "
              >
                <div class="action-icon">üìö</div>
                <div class="action-text">
                  <div class="action-title">Add Book</div>
                  <div class="action-desc">Add to collection</div>
                </div>
              </button>

              <button class="action-card" onclick="showTab('transactions')">
                <div class="action-icon">üëÅÔ∏è</div>
                <div class="action-text">
                  <div class="action-title">View Activity</div>
                  <div class="action-desc">Recent transactions</div>
                </div>
              </button>
            </div>
          </div>

          <!-- Recent Activity -->
          <div class="dashboard-sections">
            <div class="dashboard-section students-section">
              <div class="section-header-dash">
                <h3 class="section-title">Recently Added Students</h3>
                <button class="view-all-btn" onclick="showTab('students')">
                  View All ‚Üí
                </button>
              </div>
              <div id="recentStudents" class="dashboard-list">
                <p>Loading...</p>
              </div>
            </div>

            <div class="dashboard-section books-section">
              <div class="section-header-dash">
                <h3 class="section-title">Recently Added Books</h3>
                <button class="view-all-btn" onclick="showTab('books')">
                  View All ‚Üí
                </button>
              </div>
              <div id="recentBooks" class="dashboard-list">
                <p>Loading...</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- ==================== STUDENTS TAB ==================== -->
      <div id="students" class="tab-content">
        <div class="section-header">
          <div class="section-title-group">
            <h2 class="page-title">Student Management</h2>
            <p class="page-subtitle">Manage your student database</p>
          </div>
          <div class="button-group">
            <button class="btn btn-success" onclick="exportStudentsToExcel()">
              <span>üìä</span> Export to Excel
            </button>
            <button class="btn btn-primary" onclick="showAddStudentForm()">
              <span>+</span> Add Student
            </button>
          </div>
        </div>

        <!-- Add/Edit Student Form -->
        <div id="addStudentForm" class="form-container" style="display: none">
          <h3 id="studentFormTitle">Add New Student</h3>
          <form onsubmit="addStudent(event)">
            <div class="form-grid">
              <input
                type="text"
                id="studentId"
                placeholder="Student ID *"
                required
                autocomplete="off"
              />
              <input
                type="text"
                id="studentName"
                placeholder="Full Name *"
                required
                autocomplete="off"
              />
              <input
                type="email"
                id="studentEmail"
                placeholder="Email *"
                required
                autocomplete="off"
              />
              <input
                type="tel"
                id="studentPhone"
                placeholder="Phone Number"
                autocomplete="off"
              />
              <input
                type="text"
                id="studentDepartment"
                placeholder="Department"
                autocomplete="off"
              />
              <select id="studentYear">
                <option value="">Select Year</option>
                <option value="1st Year">1st Year</option>
                <option value="2nd Year">2nd Year</option>
                <option value="3rd Year">3rd Year</option>
                <option value="4th Year">4th Year</option>
                <option value="Masters">Masters</option>
                <option value="PhD">PhD</option>
              </select>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn btn-primary">
                Save Student
              </button>
              <button
                type="button"
                class="btn btn-secondary"
                onclick="hideAddStudentForm()"
              >
                Cancel
              </button>
            </div>
          </form>
        </div>

        <!-- Search Input - OUTSIDE table-container -->
        <input
          type="text"
          id="studentSearch"
          class="search-input"
          placeholder="Search students by ID, name, email, or department..."
          onkeyup="filterStudents()"
          autocomplete="off"
        />

        <!-- Table Container -->
        <div class="table-container">
          <table id="studentsTable">
            <thead>
              <tr>
                <th>Student ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Phone</th>
                <th>Department</th>
                <th>Year</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="studentsTableBody">
              <tr>
                <td colspan="7" style="text-align: center">
                  Loading students...
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- ==================== BOOKS TAB ==================== -->
      <div id="books" class="tab-content">
        <div class="section-header">
          <div class="section-title-group">
            <h2 class="page-title">Book Management</h2>
            <p class="page-subtitle">Manage your library collection</p>
          </div>
          <div class="button-group">
            <button class="btn btn-success" onclick="exportBooksToExcel()">
              <span>üìä</span> Export to Excel
            </button>
            <button class="btn btn-primary" onclick="showAddBookForm()">
              <span>+</span> Add Book
            </button>
          </div>
        </div>

        <!-- Add/Edit Book Form -->
        <div id="addBookForm" class="form-container" style="display: none">
          <h3 id="bookFormTitle">Add New Book</h3>
          <form onsubmit="addBook(event)">
            <div class="form-grid">
              <input
                type="text"
                id="bookIsbn"
                placeholder="Book No. / ISBN *"
                required
                autocomplete="off"
              />
              <input
                type="text"
                id="bookTitle"
                placeholder="Book Title *"
                required
                autocomplete="off"
              />
              <input
                type="text"
                id="bookAuthor"
                placeholder="Author *"
                required
                autocomplete="off"
              />
              <input
                type="text"
                id="bookPublisher"
                placeholder="Publisher"
                autocomplete="off"
              />
              <input
                type="text"
                id="bookCategory"
                placeholder="Category"
                autocomplete="off"
              />
              <input
                type="number"
                id="bookTotalCopies"
                placeholder="Total Copies *"
                min="1"
                required
                autocomplete="off"
              />
            </div>
            <div class="form-actions">
              <button type="submit" class="btn btn-primary">Save Book</button>
              <button
                type="button"
                class="btn btn-secondary"
                onclick="hideAddBookForm()"
              >
                Cancel
              </button>
            </div>
          </form>
        </div>

        <!-- Search Input - OUTSIDE table-container -->
        <input
          type="text"
          id="bookSearch"
          class="search-input"
          placeholder="Search books by Book No, title, author, or category..."
          onkeyup="filterBooks()"
          autocomplete="off"
        />

        <!-- Table Container -->
        <div class="table-container">
          <table id="booksTable">
            <thead>
              <tr>
                <th>Book No.</th>
                <th>Title</th>
                <th>Author</th>
                <th>Publisher</th>
                <th>Category</th>
                <th>Total Copies</th>
                <th>Available</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="booksTableBody">
              <tr>
                <td colspan="8" style="text-align: center">Loading books...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- ==================== TRANSACTIONS TAB ==================== -->
      <div id="transactions" class="tab-content">
        <div class="section-header">
          <div class="section-title-group">
            <h2 class="page-title">Book Transactions</h2>
            <p class="page-subtitle">Track book issues and returns</p>
          </div>
          <button class="btn btn-success" onclick="exportTransactionsToExcel()">
            <span>üìä</span> Export to Excel
          </button>
        </div>

        <!-- Search Input - OUTSIDE table-container -->
        <input
          type="text"
          id="transactionSearch"
          class="search-input"
          placeholder="Search transactions by student ID, student name,book No or book title..."
          onkeyup="filterTransactions()"
          autocomplete="off"
        />

        <!-- Table Container -->
        <div class="table-container">
          <table id="transactionsTable">
            <thead>
              <tr>
                <th>Student ID</th>
                <th>Student Name</th>
                <th>Book No.</th>
                <th>Book Title</th>
                <th>Issue Date</th>
                <th>Due Date</th>
                <th>Return Date</th>
                <th>Status / Actions</th>
              </tr>
            </thead>
            <tbody id="transactionsTableBody">
              <tr>
                <td colspan="8" style="text-align: center">
                  Loading transactions...
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ==================== ISSUE BOOK MODAL ==================== -->
    <div id="issueBookModal" class="modal" style="display: none">
      <div class="modal-backdrop" onclick="hideIssueBookModal()"></div>
      <div class="modal-content">
        <h3 id="issueBookTitle">Issue Book</h3>
        <form id="issueBookForm" onsubmit="issueBook(event)">
          <input type="hidden" id="issueBookIsbn" />
          <div class="form-group">
            <label for="issueStudentId"
              >Student ID <span class="required">*</span></label
            >
            <input
              type="text"
              id="issueStudentId"
              placeholder="Enter Student ID"
              required
              autocomplete="off"
            />
            <span class="help-text"
              >Enter the ID of the student who will borrow this book</span
            >
          </div>
          <div class="form-actions">
            <button type="submit" class="btn btn-primary">Issue Book</button>
            <button
              type="button"
              class="btn btn-secondary"
              onclick="hideIssueBookModal()"
            >
              Cancel
            </button>
          </div>
        </form>
      </div>
    </div>

    <script>
      require("./js/app.js");
    </script>
  </body>
</html>
